import{j as e,A as E,m as M,r as n,a as K,u as Q}from"./index-DGNH6TTz.js";import{o as X,k as L,c as P,l as Y,h as T,b as B,d as g,f as Z,m as ee,u as se}from"./firebase-DP6Zpsn6.js";function D({isOpen:l,onClose:c,children:r}){return e.jsx(E,{children:l&&e.jsx(M.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:c,children:e.jsx(M.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},transition:{type:"spring",stiffness:300,damping:30},className:"bg-slate-800 border border-slate-700 rounded-xl p-6 w-full max-w-lg shadow-2xl",onClick:a=>a.stopPropagation(),children:r})})})}function te({onSave:l,onCancel:c,course:r}){const[a,i]=n.useState({name:"",courseCode:"",description:"",instructor:"PMA",basePrice:0,earlyBirdPrice:0,earlyBirdSlots:0,totalSlots:0,whatsappLink:"",thumbnail:"",highlights:[],offerText:""}),[h,p]=n.useState("");n.useEffect(()=>{i(r?{name:r.name||"",courseCode:r.courseCode||"",description:r.description||"",instructor:r.instructor||"PMA",basePrice:r.basePrice||0,earlyBirdPrice:r.earlyBirdPrice||0,earlyBirdSlots:r.earlyBirdSlots||0,totalSlots:r.totalSlots||0,whatsappLink:r.whatsappLink||"",thumbnail:r.thumbnail||"",highlights:r.highlights||[],offerText:r.offerText||""}:{name:"",courseCode:"",description:"",instructor:"PMA",basePrice:0,earlyBirdPrice:0,earlyBirdSlots:0,totalSlots:0,whatsappLink:"",thumbnail:"",highlights:[],offerText:""})},[r]);const t=o=>{const{name:u,value:b,type:f}=o.target;i(C=>({...C,[u]:f==="number"?parseInt(b,10)||0:b}))},m=()=>{h.trim()&&(i(o=>({...o,highlights:[...o.highlights,h.trim()]})),p(""))},w=o=>{i(u=>({...u,highlights:u.highlights.filter((b,f)=>f!==o)}))},N=o=>{o.preventDefault(),l(a)};return e.jsxs("form",{onSubmit:N,className:"space-y-4 text-slate-300",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:r?"Edit Course":"Add New Course"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{name:"name",value:a.name,onChange:t,placeholder:"Course Name",className:"w-full p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md focus:ring-purple-500 focus:border-purple-500",required:!0}),e.jsx("input",{name:"courseCode",value:a.courseCode,onChange:t,placeholder:"Course Code (e.g., UCM)",className:"w-full p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md disabled:bg-slate-800 disabled:text-slate-400",required:!0,disabled:!!r})]}),e.jsx("textarea",{name:"description",value:a.description,onChange:t,placeholder:"Description",className:"w-full h-24 p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md focus:ring-purple-500 focus:border-purple-500",required:!0}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{name:"instructor",value:a.instructor,onChange:t,placeholder:"Instructor Name",className:"w-full p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md focus:ring-purple-500 focus:border-purple-500",required:!0}),e.jsx("input",{name:"thumbnail",value:a.thumbnail,onChange:t,placeholder:"Thumbnail Image URL",className:"w-full p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md focus:ring-purple-500 focus:border-purple-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Base Price (₹)"}),e.jsx("input",{name:"basePrice",type:"number",value:a.basePrice,onChange:t,placeholder:"1999",className:"w-full p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Early Bird Price (₹)"}),e.jsx("input",{name:"earlyBirdPrice",type:"number",value:a.earlyBirdPrice,onChange:t,placeholder:"1499",className:"w-full p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Early Bird Slots"}),e.jsx("input",{name:"earlyBirdSlots",type:"number",value:a.earlyBirdSlots,onChange:t,placeholder:"10",className:"w-full p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Total Slots"}),e.jsx("input",{name:"totalSlots",type:"number",value:a.totalSlots,onChange:t,placeholder:"50",className:"w-full p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"WhatsApp Group Link"}),e.jsx("input",{name:"whatsappLink",value:a.whatsappLink,onChange:t,placeholder:"https://chat.whatsapp.com/...",className:"w-full p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Offer Text (Optional)"}),e.jsx("input",{name:"offerText",value:a.offerText,onChange:t,placeholder:"e.g., Limited Time!",className:"w-full p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Course Highlights"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:h,onChange:o=>p(o.target.value),placeholder:"Add a learning point",className:"flex-grow p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md"}),e.jsx("button",{type:"button",onClick:m,className:"px-4 py-2 rounded-md font-semibold bg-indigo-600 hover:bg-indigo-500 text-white transition",children:"Add"})]}),e.jsx("ul",{className:"mt-3 space-y-2",children:a.highlights.map((o,u)=>e.jsxs("li",{className:"flex justify-between items-center bg-slate-700 p-2 rounded-md",children:[e.jsx("span",{children:o}),e.jsx("button",{type:"button",onClick:()=>w(u),className:"text-red-400 hover:text-red-300",children:"✕"})]},u))})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[e.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 rounded-md font-semibold bg-slate-600 hover:bg-slate-500 text-white transition",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded-md font-semibold bg-purple-600 hover:bg-purple-500 text-white transition",children:"Save Course"})]})]})}const re=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),ae=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"}),e.jsx("path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"})]}),ne=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 9 7c0 1.3.5 2.6 1.5 3.5.7.8 1.3 1.5 1.5 2.5"}),e.jsx("path",{d:"M9 18h6"}),e.jsx("path",{d:"M10 22h4"})]}),le=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),e.jsx("polyline",{points:"16 17 21 12 16 7"}),e.jsx("line",{x1:"21",x2:"9",y1:"12",y2:"12"})]}),oe=({isOpen:l,onClose:c,onConfirm:r,title:a,message:i})=>e.jsxs(D,{isOpen:l,onClose:c,children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:a}),e.jsx("p",{className:"text-slate-400 mt-2 text-sm",children:i}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:c,className:"px-4 py-2 rounded-md text-sm font-semibold bg-slate-600 hover:bg-slate-500 text-white transition",children:"Cancel"}),e.jsx("button",{onClick:r,className:"px-4 py-2 rounded-md text-sm font-semibold bg-red-600 hover:bg-red-500 text-white transition",children:"Confirm"})]})]}),ie=({regs:l,search:c,filter:r,onConfirm:a})=>{const i=t=>r==="all"?!0:r==="confirmed"?t.confirmed:r==="pending"?!t.confirmed:!1,h=l.filter(i).filter(t=>{var m;return(((m=t.name)==null?void 0:m.toLowerCase())||"").includes(c.toLowerCase())||(t.phone||"").includes(c)}),p=t=>t.confirmed?e.jsx("span",{className:"px-2 py-1 text-xs font-semibold text-green-300 bg-green-500/20 rounded-full",children:"Confirmed"}):t.paymentStatus==="full_payment_pending"?e.jsx("span",{className:"px-2 py-1 text-xs font-semibold text-yellow-300 bg-yellow-500/20 rounded-full",children:"Pending Full Payment"}):t.paymentStatus==="seat_lock_pending"?e.jsx("span",{className:"px-2 py-1 text-xs font-semibold text-blue-300 bg-blue-500/20 rounded-full",children:"Pending Seat Lock"}):e.jsx("span",{className:"px-2 py-1 text-xs font-semibold text-slate-300 bg-slate-500/20 rounded-full",children:"Pending"});return e.jsx("div",{className:"space-y-4",children:h.length===0?e.jsx("p",{className:"text-center text-slate-500 py-8",children:"No registrations found."}):h.map(t=>{var m;return e.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 p-4 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-lg text-white",children:t.name||"No Name"}),e.jsxs("p",{className:"text-sm text-slate-400",children:[t.phone||"No Phone"," | ",t.college||"N/A"]})]}),p(t)]}),e.jsxs("div",{className:"mt-3 border-t border-slate-700 pt-3 text-sm text-slate-300 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Course:"})," ",e.jsx("span",{className:"font-semibold text-purple-400",children:t.courseId==="bundle"?"Combined Course Bundle":(m=t.courseId)==null?void 0:m.toUpperCase()})]}),t.isFromBundle&&e.jsx("p",{className:"text-xs text-purple-400",children:"(Part of a bundle purchase)"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Payment:"})," Paid ₹",t.amountPaid," (Offered: ₹",t.priceOffered,")"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Screenshot:"})," ",t.screenshotUrl?e.jsx("a",{href:t.screenshotUrl,target:"_blank",rel:"noreferrer",className:"underline text-indigo-400 hover:text-indigo-300",children:"View Screenshot"}):"None"]})]}),!t.confirmed&&e.jsx("div",{className:"mt-4 text-right",children:e.jsx("button",{onClick:()=>a(t),className:"bg-green-600 hover:bg-green-700 text-white font-bold px-4 py-2 rounded-md transition-colors text-sm",children:"Confirm Registration"})})]},t.id)})})};function ue(){const{showNotification:l}=K(),c=Q(),[r,a]=n.useState(null),[i,h]=n.useState("registrations"),[p,t]=n.useState([]),[m,w]=n.useState(!0),[N,o]=n.useState("all"),[u,b]=n.useState(""),[f,C]=n.useState([]),[F,q]=n.useState(!0),[U,A]=n.useState(!1),[v,O]=n.useState(null),[I,H]=n.useState([]),[_,W]=n.useState(!0),[z,j]=n.useState({isOpen:!1,onConfirm:null,title:"",message:""});n.useEffect(()=>{const s=X(T,d=>{d&&d.email?a(d):c("/login")});return()=>s()},[c]),n.useEffect(()=>{if(!r)return;const s=L(P(g,"registrations"),y=>{t(y.docs.map(x=>({id:x.id,...x.data()}))),w(!1)}),d=L(P(g,"courses"),y=>{C(y.docs.map(x=>({id:x.id,...x.data()}))),q(!1)}),S=L(P(g,"suggestions"),y=>{H(y.docs.map(x=>({id:x.id,...x.data()}))),W(!1)});return()=>{s(),d(),S()}},[r]);const V=s=>{j({isOpen:!0,title:"Confirm Registration?",message:`Are you sure you have verified the payment for ${s.name}? This action cannot be undone.`,onConfirm:async()=>{try{await se(B(g,"registrations",s.id),{confirmed:!0}),l("Registration confirmed!","success")}catch(d){l("Failed to confirm registration.","error"),console.error(d)}finally{j({isOpen:!1})}}})},$=async s=>{if(s.courseCode.includes("/")){l('Error: Course Code cannot contain a forward slash ("/").',"error");return}try{const d=v?v.id:s.courseCode.toLowerCase(),S=B(g,"courses",d);await Z(S,s,{merge:!0}),l(v?"Course updated!":"Course added!","success"),k()}catch(d){l("Failed to save course. Check console for details.","error"),console.error("Firebase save error: ",d)}},G=s=>{j({isOpen:!0,title:"Delete Course?",message:`Are you sure you want to delete this course (${s.toUpperCase()})? This cannot be undone.`,onConfirm:async()=>{try{await ee(B(g,"courses",s)),l("Course deleted.","success")}catch(d){l("Failed to delete course.","error"),console.error(d)}finally{j({isOpen:!1})}}})},R=(s=null)=>{O(s),A(!0)},k=()=>{A(!1),O(null)};if(!r)return e.jsx("div",{className:"bg-slate-900 min-h-screen flex items-center justify-center text-white",children:"Checking authentication..."});const J=()=>{switch(i){case"registrations":return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-3 mb-4 items-center bg-slate-800/50 p-3 rounded-lg border border-slate-700",children:[e.jsx("div",{className:"flex gap-2",children:["all","pending","confirmed"].map(s=>e.jsx("button",{onClick:()=>o(s),className:`px-4 py-2 rounded-md text-sm font-semibold transition ${N===s?"bg-purple-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:s.charAt(0).toUpperCase()+s.slice(1)},s))}),e.jsx("input",{type:"text",placeholder:"Search by name or phone...",value:u,onChange:s=>b(s.target.value),className:"w-full md:w-auto md:ml-auto px-3 py-2 bg-slate-700/50 border-2 border-slate-600 rounded-md shadow-sm focus:ring-purple-500 focus:border-purple-500 text-white"})]}),m?e.jsx("p",{className:"text-center text-slate-400 py-4",children:"Loading registrations..."}):e.jsx(ie,{regs:p,search:u,filter:N,onConfirm:V})]});case"courses":return e.jsxs("div",{children:[e.jsx("div",{className:"text-right mb-4",children:e.jsx("button",{onClick:()=>R(),className:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-md",children:"Add New Course"})}),F?e.jsx("p",{className:"text-center text-slate-400 py-4",children:"Loading courses..."}):e.jsx("div",{className:"space-y-4",children:f.map(s=>e.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 p-4 rounded-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-white",children:s.name}),e.jsx("p",{className:"text-sm text-slate-400",children:s.id.toUpperCase()})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>R(s),className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-1 px-3 rounded-md text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>G(s.id),className:"bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-3 rounded-md text-sm",children:"Delete"})]})]},s.id))})]});case"suggestions":return e.jsx("div",{className:"bg-slate-800/50 border border-slate-700 p-4 rounded-lg",children:_?e.jsx("p",{className:"text-center text-slate-400 py-4",children:"Loading suggestions..."}):e.jsx("div",{className:"space-y-4",children:I.length===0?e.jsx("p",{className:"text-center text-slate-500 py-4",children:"No suggestions yet."}):I.map(s=>e.jsxs("div",{className:"border-b border-slate-700 p-4 last:border-b-0",children:[e.jsxs("p",{className:"font-semibold text-white",children:['"',s.text,'"']}),e.jsxs("p",{className:"text-xs text-slate-400 mt-2",children:["By: ",s.userPhone||s.userId," on ",new Date(s.submittedAt.seconds*1e3).toLocaleString()]})]},s.id))})});default:return null}};return e.jsxs("div",{className:"min-h-screen bg-slate-900 text-slate-200",children:[e.jsx(oe,{...z,onClose:()=>j({isOpen:!1})}),e.jsx(D,{isOpen:U,onClose:k,children:e.jsx(te,{onSave:$,onCancel:k,course:v})}),e.jsx("header",{className:"bg-slate-800/80 backdrop-blur-sm shadow-md border-b border-slate-700 sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8 flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Admin Panel"}),e.jsxs("button",{onClick:()=>Y(T),className:"bg-red-600/80 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-lg flex items-center gap-2 transition",children:[e.jsx(le,{}),e.jsx("span",{children:"Log out"})]})]})}),e.jsx("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"px-4 py-6 sm:px-0",children:[e.jsx("div",{className:"border-b border-slate-700 mb-6",children:e.jsx("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[{key:"registrations",label:"Registrations",icon:e.jsx(re,{})},{key:"courses",label:"Courses",icon:e.jsx(ae,{})},{key:"suggestions",label:"Suggestions",icon:e.jsx(ne,{})}].map(s=>e.jsxs("button",{onClick:()=>h(s.key),className:`flex items-center gap-2 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition ${i===s.key?"border-purple-500 text-purple-400":"border-transparent text-slate-400 hover:text-slate-200 hover:border-slate-500"}`,children:[s.icon," ",s.label]},s.key))})}),e.jsx(E,{mode:"wait",children:e.jsx(M.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:J()},i)})]})})]})}export{ue as default};
