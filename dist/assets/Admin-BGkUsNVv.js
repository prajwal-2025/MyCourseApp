import{j as e,A as I,m as P,r as a,u as K,b as Q,o as X,l as k,c as S,n as Y,h as O,e as L,d as g,s as Z,p as ee,t as se}from"./index-BjUV0rAk.js";function R({isOpen:l,onClose:d,children:n}){return e.jsx(I,{children:l&&e.jsx(P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:d,children:e.jsx(P.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},transition:{type:"spring",stiffness:300,damping:30},className:"bg-slate-800 border border-slate-700 rounded-xl p-6 w-full max-w-lg shadow-2xl",onClick:r=>r.stopPropagation(),children:n})})})}function te({onSave:l,onCancel:d,course:n}){const[r,c]=a.useState({name:"",courseCode:"",description:"",instructor:"PMA",basePrice:0,earlyBirdPrice:0,earlyBirdSlots:0,totalSlots:0,whatsappLink:"",thumbnail:"",highlights:[]}),[x,p]=a.useState("");a.useEffect(()=>{n&&c({...n,highlights:n.highlights||[]})},[n]);const t=o=>{const{name:u,value:b,type:f}=o.target;c(w=>({...w,[u]:f==="number"?parseInt(b,10)||0:b}))},m=()=>{x.trim()&&(c(o=>({...o,highlights:[...o.highlights,x.trim()]})),p(""))},v=o=>{c(u=>({...u,highlights:u.highlights.filter((b,f)=>f!==o)}))},N=o=>{o.preventDefault(),l(r)};return e.jsxs("form",{onSubmit:N,className:"space-y-4 text-slate-300",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:n?"Edit Course":"Add New Course"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{name:"name",value:r.name,onChange:t,placeholder:"Course Name",className:"w-full p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md focus:ring-purple-500 focus:border-purple-500",required:!0}),e.jsx("input",{name:"courseCode",value:r.courseCode,onChange:t,placeholder:"Course Code (e.g., UCM)",className:"w-full p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md disabled:bg-slate-800 disabled:text-slate-400",required:!0,disabled:!!n})]}),e.jsx("textarea",{name:"description",value:r.description,onChange:t,placeholder:"Description",className:"w-full h-24 p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md focus:ring-purple-500 focus:border-purple-500",required:!0}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("input",{name:"instructor",value:r.instructor,onChange:t,placeholder:"Instructor Name",className:"w-full p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md focus:ring-purple-500 focus:border-purple-500",required:!0}),e.jsx("input",{name:"thumbnail",value:r.thumbnail,onChange:t,placeholder:"Thumbnail Image URL",className:"w-full p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md focus:ring-purple-500 focus:border-purple-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Base Price (₹)"}),e.jsx("input",{name:"basePrice",type:"number",value:r.basePrice,onChange:t,placeholder:"1999",className:"w-full p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Early Bird Price (₹)"}),e.jsx("input",{name:"earlyBirdPrice",type:"number",value:r.earlyBirdPrice,onChange:t,placeholder:"1499",className:"w-full p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Early Bird Slots"}),e.jsx("input",{name:"earlyBirdSlots",type:"number",value:r.earlyBirdSlots,onChange:t,placeholder:"10",className:"w-full p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Total Slots"}),e.jsx("input",{name:"totalSlots",type:"number",value:r.totalSlots,onChange:t,placeholder:"50",className:"w-full p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"WhatsApp Group Link"}),e.jsx("input",{name:"whatsappLink",value:r.whatsappLink,onChange:t,placeholder:"https://chat.whatsapp.com/...",className:"w-full p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Course Highlights"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:x,onChange:o=>p(o.target.value),placeholder:"Add a learning point",className:"flex-grow p-3 bg-slate-700/50 border-2 border-slate-600 rounded-md"}),e.jsx("button",{type:"button",onClick:m,className:"px-4 py-2 rounded-md font-semibold bg-indigo-600 hover:bg-indigo-500 text-white transition",children:"Add"})]}),e.jsx("ul",{className:"mt-3 space-y-2",children:r.highlights.map((o,u)=>e.jsxs("li",{className:"flex justify-between items-center bg-slate-700 p-2 rounded-md",children:[e.jsx("span",{children:o}),e.jsx("button",{type:"button",onClick:()=>v(u),className:"text-red-400 hover:text-red-300",children:"✕"})]},u))})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[e.jsx("button",{type:"button",onClick:d,className:"px-4 py-2 rounded-md font-semibold bg-slate-600 hover:bg-slate-500 text-white transition",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 rounded-md font-semibold bg-purple-600 hover:bg-purple-500 text-white transition",children:"Save Course"})]})]})}const re=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),ne=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"}),e.jsx("path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"})]}),ae=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 9 7c0 1.3.5 2.6 1.5 3.5.7.8 1.3 1.5 1.5 2.5"}),e.jsx("path",{d:"M9 18h6"}),e.jsx("path",{d:"M10 22h4"})]}),le=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),e.jsx("polyline",{points:"16 17 21 12 16 7"}),e.jsx("line",{x1:"21",x2:"9",y1:"12",y2:"12"})]}),oe=({isOpen:l,onClose:d,onConfirm:n,title:r,message:c})=>e.jsxs(R,{isOpen:l,onClose:d,children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:r}),e.jsx("p",{className:"text-slate-400 mt-2 text-sm",children:c}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:d,className:"px-4 py-2 rounded-md text-sm font-semibold bg-slate-600 hover:bg-slate-500 text-white transition",children:"Cancel"}),e.jsx("button",{onClick:n,className:"px-4 py-2 rounded-md text-sm font-semibold bg-red-600 hover:bg-red-500 text-white transition",children:"Confirm"})]})]}),ie=({regs:l,search:d,filter:n,onConfirm:r})=>{const c=t=>n==="all"?!0:n==="confirmed"?t.confirmed:n==="pending"?!t.confirmed:!1,x=l.filter(c).filter(t=>{var m;return(((m=t.name)==null?void 0:m.toLowerCase())||"").includes(d.toLowerCase())||(t.phone||"").includes(d)}),p=t=>t.confirmed?e.jsx("span",{className:"px-2 py-1 text-xs font-semibold text-green-300 bg-green-500/20 rounded-full",children:"Confirmed"}):t.paymentStatus==="full_payment_pending"?e.jsx("span",{className:"px-2 py-1 text-xs font-semibold text-yellow-300 bg-yellow-500/20 rounded-full",children:"Pending Full Payment"}):t.paymentStatus==="seat_lock_pending"?e.jsx("span",{className:"px-2 py-1 text-xs font-semibold text-blue-300 bg-blue-500/20 rounded-full",children:"Pending Seat Lock"}):e.jsx("span",{className:"px-2 py-1 text-xs font-semibold text-slate-300 bg-slate-500/20 rounded-full",children:"Pending"});return e.jsx("div",{className:"space-y-4",children:x.length===0?e.jsx("p",{className:"text-center text-slate-500 py-8",children:"No registrations found."}):x.map(t=>{var m;return e.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 p-4 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-lg text-white",children:t.name||"No Name"}),e.jsxs("p",{className:"text-sm text-slate-400",children:[t.phone||"No Phone"," | ",t.college||"N/A"]})]}),p(t)]}),e.jsxs("div",{className:"mt-3 border-t border-slate-700 pt-3 text-sm text-slate-300 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Course:"})," ",e.jsx("span",{className:"font-semibold text-purple-400",children:t.courseId==="bundle"?"Combined Course Bundle":(m=t.courseId)==null?void 0:m.toUpperCase()})]}),t.isFromBundle&&e.jsx("p",{className:"text-xs text-purple-400",children:"(Part of a bundle purchase)"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Payment:"})," Paid ₹",t.amountPaid," (Offered: ₹",t.priceOffered,")"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Screenshot:"})," ",t.screenshotUrl?e.jsx("a",{href:t.screenshotUrl,target:"_blank",rel:"noreferrer",className:"underline text-indigo-400 hover:text-indigo-300",children:"View Screenshot"}):"None"]})]}),!t.confirmed&&e.jsx("div",{className:"mt-4 text-right",children:e.jsx("button",{onClick:()=>r(t),className:"bg-green-600 hover:bg-green-700 text-white font-bold px-4 py-2 rounded-md transition-colors text-sm",children:"Confirm Registration"})})]},t.id)})})};function ce(){const{showNotification:l}=K(),d=Q(),[n,r]=a.useState(null),[c,x]=a.useState("registrations"),[p,t]=a.useState([]),[m,v]=a.useState(!0),[N,o]=a.useState("all"),[u,b]=a.useState(""),[f,w]=a.useState([]),[E,q]=a.useState(!0),[D,M]=a.useState(!1),[F,U]=a.useState(null),[A,H]=a.useState([]),[_,T]=a.useState(!0),[W,j]=a.useState({isOpen:!1,onConfirm:null,title:"",message:""});a.useEffect(()=>{const s=X(O,i=>{i&&i.email?r(i):d("/login")});return()=>s()},[d]),a.useEffect(()=>{if(!n)return;const s=k(S(g,"registrations"),y=>{t(y.docs.map(h=>({id:h.id,...h.data()}))),v(!1)}),i=k(S(g,"courses"),y=>{w(y.docs.map(h=>({id:h.id,...h.data()}))),q(!1)}),J=k(S(g,"suggestions"),y=>{H(y.docs.map(h=>({id:h.id,...h.data()}))),T(!1)});return()=>{s(),i(),J()}},[n]);const z=s=>{j({isOpen:!0,title:"Confirm Registration?",message:`Are you sure you have verified the payment for ${s.name}? This action cannot be undone.`,onConfirm:async()=>{try{await se(L(g,"registrations",s.id),{confirmed:!0}),l("Registration confirmed!","success")}catch(i){l("Failed to confirm registration.","error"),console.error(i)}finally{j({isOpen:!1})}}})},V=async s=>{try{const i=L(g,"courses",s.id||s.courseCode.toLowerCase());await Z(i,s,{merge:!0}),l(s.id?"Course updated!":"Course added!","success"),C()}catch(i){l("Failed to save course.","error"),console.error(i)}},$=s=>{j({isOpen:!0,title:"Delete Course?",message:`Are you sure you want to delete this course (${s.toUpperCase()})? This cannot be undone.`,onConfirm:async()=>{try{await ee(L(g,"courses",s)),l("Course deleted.","success")}catch(i){l("Failed to delete course.","error"),console.error(i)}finally{j({isOpen:!1})}}})},B=(s=null)=>{U(s),M(!0)},C=()=>M(!1);if(!n)return e.jsx("div",{className:"bg-slate-900 min-h-screen flex items-center justify-center text-white",children:"Checking authentication..."});const G=()=>{switch(c){case"registrations":return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-3 mb-4 items-center bg-slate-800/50 p-3 rounded-lg border border-slate-700",children:[e.jsx("div",{className:"flex gap-2",children:["all","pending","confirmed"].map(s=>e.jsx("button",{onClick:()=>o(s),className:`px-4 py-2 rounded-md text-sm font-semibold transition ${N===s?"bg-purple-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:s.charAt(0).toUpperCase()+s.slice(1)},s))}),e.jsx("input",{type:"text",placeholder:"Search by name or phone...",value:u,onChange:s=>b(s.target.value),className:"w-full md:w-auto md:ml-auto px-3 py-2 bg-slate-700/50 border-2 border-slate-600 rounded-md shadow-sm focus:ring-purple-500 focus:border-purple-500 text-white"})]}),m?e.jsx("p",{className:"text-center text-slate-400 py-4",children:"Loading registrations..."}):e.jsx(ie,{regs:p,search:u,filter:N,onConfirm:z})]});case"courses":return e.jsxs("div",{children:[e.jsx("div",{className:"text-right mb-4",children:e.jsx("button",{onClick:()=>B(),className:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-md",children:"Add New Course"})}),E?e.jsx("p",{className:"text-center text-slate-400 py-4",children:"Loading courses..."}):e.jsx("div",{className:"space-y-4",children:f.map(s=>e.jsxs("div",{className:"bg-slate-800/50 border border-slate-700 p-4 rounded-lg flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-white",children:s.name}),e.jsx("p",{className:"text-sm text-slate-400",children:s.id.toUpperCase()})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>B(s),className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-1 px-3 rounded-md text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>$(s.id),className:"bg-red-600 hover:bg-red-700 text-white font-bold py-1 px-3 rounded-md text-sm",children:"Delete"})]})]},s.id))})]});case"suggestions":return e.jsx("div",{className:"bg-slate-800/50 border border-slate-700 p-4 rounded-lg",children:_?e.jsx("p",{className:"text-center text-slate-400 py-4",children:"Loading suggestions..."}):e.jsx("div",{className:"space-y-4",children:A.length===0?e.jsx("p",{className:"text-center text-slate-500 py-4",children:"No suggestions yet."}):A.map(s=>e.jsxs("div",{className:"border-b border-slate-700 p-4 last:border-b-0",children:[e.jsxs("p",{className:"font-semibold text-white",children:['"',s.text,'"']}),e.jsxs("p",{className:"text-xs text-slate-400 mt-2",children:["By: ",s.userPhone||s.userId," on ",new Date(s.submittedAt.seconds*1e3).toLocaleString()]})]},s.id))})});default:return null}};return e.jsxs("div",{className:"min-h-screen bg-slate-900 text-slate-200",children:[e.jsx(oe,{...W,onClose:()=>j({isOpen:!1})}),e.jsx(R,{isOpen:D,onClose:C,children:e.jsx(te,{onSave:V,onCancel:C,course:F})}),e.jsx("header",{className:"bg-slate-800/80 backdrop-blur-sm shadow-md border-b border-slate-700 sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8 flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Admin Panel"}),e.jsxs("button",{onClick:()=>Y(O),className:"bg-red-600/80 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-lg flex items-center gap-2 transition",children:[e.jsx(le,{}),e.jsx("span",{children:"Log out"})]})]})}),e.jsx("main",{className:"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"px-4 py-6 sm:px-0",children:[e.jsx("div",{className:"border-b border-slate-700 mb-6",children:e.jsx("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[{key:"registrations",label:"Registrations",icon:e.jsx(re,{})},{key:"courses",label:"Courses",icon:e.jsx(ne,{})},{key:"suggestions",label:"Suggestions",icon:e.jsx(ae,{})}].map(s=>e.jsxs("button",{onClick:()=>x(s.key),className:`flex items-center gap-2 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition ${c===s.key?"border-purple-500 text-purple-400":"border-transparent text-slate-400 hover:text-slate-200 hover:border-slate-500"}`,children:[s.icon," ",s.label]},s.key))})}),e.jsx(I,{mode:"wait",children:e.jsx(P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:G()},c)})]})})]})}export{ce as default};
